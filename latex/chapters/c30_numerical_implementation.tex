% !TEX root = ../main.tex
\chapter{Numerical Implementation}
\label{chap:numerical_implementation}

\noindent
This chapter presents the computational framework developed for simulating one- and two-dimensional electronic spectroscopy of open quantum systems. The implementation is built around the \texttt{qspectro2d} Python package, which provides a modular, configuration-driven workflow that bridges the theoretical framework established in previous chapters with practical computational methods for investigating quantum coherence phenomena in complex molecular systems.

\section{Software Architecture and Design Philosophy}
\label{sec:software_architecture}

\noindent
The \texttt{qspectro2d} package follows a modular design that separates concerns across distinct functional domains. The architecture enables efficiency through parallel processing and flexible configuration management. The core design is built around a \textbf{configuration-driven workflow} where YAML-based parameter specification decouples physical models from computational implementation. This approach ensures that \textbf{modular components} including atomic systems, laser pulses, environmental baths, and spectroscopic calculations remain independently configurable. The framework provides \textbf{scalable execution} with support for both local testing and high-performance computing (HPC) batch processing, complemented by \textbf{comprehensive post-processing} through automated workflows for averaging, Fourier transforms, and visualization.

\noindent
The package structure comprises five main submodules: \texttt{core} (fundamental system components), \texttt{spectroscopy} (calculation engines), \texttt{config} (parameter management), \texttt{utils} (data handling utilities), and \texttt{visualization} (plotting tools).

\section{Configuration-Driven Simulation Workflow}
\label{sec:configuration_workflow}

\noindent
The simulation framework employs YAML configuration files to specify all physical and computational parameters, enabling reproducible plotes. A typical configuration defines the \textbf{atomic system} through the number of atoms, transition frequencies, geometric arrangement, and inhomogeneous broadening parameters. \textbf{Laser parameters} encompass pulse amplitudes, durations, carrier frequencies, and rotating wave approximation settings, while \textbf{environmental coupling} is characterized by bath type (Ohmic, Drude-Lorentz), temperature, coupling strength, and cutoff frequencies. Finally, \textbf{computational settings} specify the ODE solver choice (Lindblad vs. Bloch-Redfield), signal types, and time windows.

\noindent
The workflow consists of three main execution phases: simulation (\texttt{calc\_datas.py}), post-processing (\texttt{process\_datas.py}), and visualization (\texttt{plot\_datas.py}). This separation enables efficient parameter studies where computationally expensive simulations are performed once, followed by rapid exploration of different analysis and visualization options.

\section{Third-Order Polarization and Phase Cycling}
\label{sec:third_order_polarization}

\noindent
In the numerical implementation, the electric field for multiple pulses is modeled following the formalism established in Chapter~\ref{chapter_spectroscopy}. The total electric field is expressed as

\begin{equation}
	\vec{E}(\vec{r},t) = \sum_{m=1}^{3} \vec{E}_m(\vec{r},t) + \mathrm{c.c.},
\end{equation}

where c.c. denotes the complex conjugate, and

\begin{equation}
	\vec{E}_m(\vec{r},t) = \vec{\chi}_m E'_m(t - \tau_m) \exp(-i (\omega_m t + \varphi_m)),
\end{equation}

with frequency $\omega_m = 2\pi \nu_m$, wavevector $\vec{k}_m$, and electric field amplitude $\vec{\chi}_m$. The envelope $E'_m(t - \tau_m)$, centered at $\tau_m$, is assumed to be Gaussian with FWHM $\tau_p$

\begin{equation}
	E'_m(t - \tau_m) = \exp\left( -\frac{4 \ln 2 (t - \tau_m)^2}{\tau_p^2} \right).
\end{equation}

\noindent
The core spectroscopic calculation implements phase-cycled third-order polarization measurement following the established four-wave mixing protocols detailed in Chapter~\ref{chapter_spectroscopy}, Section~\ref{subsec:phase_cycling}.
\noindent
The implementation computes individual third orderp olarization components by subtracting the phase-cycled individual signals from the total one:
$P_{\phi_1,\phi_2}^{(3)}(t) = P_{\text{total}}(t) - \sum_i P_i(t)$, where $P_{\text{total}}$ includes all pulses and $P_i$ represents evolution with only pulse $i$ active. This approach enables isolation of the desired third-order response while automatically handling pulse overlap effects.

\section{Open Quantum System Evolution}
\label{sec:oqs_evolution}

\noindent
The quantum system evolution is handled by the \texttt{SimulationModuleOQS} class, which provides a unified interface for different solver backends implementing the open quantum system dynamics developed in Chapter~\ref{chapter_open_quantum_systems}. The implementation supports both Lindblad master equation evolution (via QuTiP's \texttt{mesolve}) and Bloch-Redfield dynamics (\texttt{brmesolve}) with automatic handling of pulse overlap and time-dependent Hamiltonians.

\noindent
For time-dependent pulse sequences, the total Hamiltonian takes the form established in the spectroscopy theory (Chapter~\ref{chapter_spectroscopy}):

\begin{equation}
	\label{eq:time_dependent_hamiltonian}
	H(t) = H_0 + \sum_{i} H_{\text{int},i}(t)
\end{equation}

\noindent
where $H_0$ is the bare system Hamiltonian and $H_{\text{int},i}(t)$ represents the interaction with pulse $i$, following the light-matter interaction formalism detailed in Chapter~\ref{chapter_spectroscopy}. The solver automatically detects pulse overlap regions and constructs appropriate piecewise evolution operators, ensuring accurate treatment of multi-pulse sequences regardless of timing complexity.

\section{Inhomogeneous Broadening and Statistical Averaging}
\label{sec:inhomogeneous_broadening}

\noindent
Real molecular systems exhibit inhomogeneous broadening due to environmental variations, as discussed in the spectroscopy fundamentals (Chapter~\ref{chapter_spectroscopy}). The implementation models this through Gaussian-distributed transition frequencies following the theoretical treatment:

\begin{equation}
	\label{eq:gaussian_broadening}
	\rho(\omega) = \frac{1}{\sigma\sqrt{2\pi}} \exp\left(-\frac{(\omega-\omega_0)^2}{2\sigma^2}\right)
\end{equation}

\noindent
where $\sigma = \Delta_{\text{FWHM}}/(2\sqrt{2\ln 2})$ relates the standard deviation to the experimentally relevant full width at half maximum, consistent with the broadening models established in Chapter~\ref{chapter_spectroscopy}. The sampling employs a rejection algorithm optimized for computational efficiency while maintaining statistical accuracy.

\section{Parallel Processing and Scalable Execution}
\label{sec:parallel_processing}

\noindent
The framework supports both local execution for testing and HPC cluster deployment for large parameter studies. The local workflow (\texttt{calc\_datas.py}) generates all combinations of coherence times and inhomogeneous samples, while the HPC workflow (\texttt{hpc\_batch\_dispatch.py}) distributes individual parameter combinations across compute nodes.

\noindent
For each combination of parameters, the averaged response is calculated following the inhomogeneous averaging procedure established in the spectroscopy theory (Chapter~\ref{chapter_spectroscopy}):

\begin{equation}
	\label{eq:averaged_response}
	\langle E_{k_s}(t_{\text{coh}}, t_{\text{det}}) \rangle = \frac{1}{N_{\text{inhom}}} \sum_{i=1}^{N_{\text{inhom}}} E_{k_s}^{(i)}(t_{\text{coh}}, t_{\text{det}})
\end{equation}

\noindent
where $N_{\text{inhom}}$ represents the number of inhomogeneous samples as defined in the broadening treatment (Chapter~\ref{chapter_spectroscopy}). The implementation utilizes Python's \texttt{ProcessPoolExecutor} for local parallel execution and integrates with SLURM-based job scheduling systems for HPC deployment, enabling efficient scaling from desktop testing to production-scale parameter sweeps.

\section{Post-Processing and Spectral Analysis}
\label{sec:post_processing}

\noindent
The post-processing pipeline (\texttt{process\_datas.py}) handles the conversion from time-domain signals to 2D spectra. \textbf{Data aggregation} groups individual parameter combination files by inhomogeneous sample and stacks them along coherence time dimensions. \textbf{Zero-padding} extends the time-domain data to improve frequency resolution according to:

\begin{equation}
	\label{eq:zero_padding}
	E_{\text{extended}}(t) = \begin{cases}
		E(t) & \text{for } t \in [0, T_{\text{orig}}] \\
		0 & \text{for } t \in (T_{\text{orig}}, T_{\text{extended}}]
	\end{cases}
\end{equation}

\noindent
Subsequently, \textbf{Fourier transformation} converts the data to frequency domain using Eq. \eqref{eq:rephasing_transform}.

\noindent
The frequency axes are expressed in wavenumber units ($10^4$ cm$^{-1}$) for direct comparison with experimental literature.

\section{Model System Implementation}
\label{sec:model_systems}

\noindent
The \texttt{AtomicSystem} class provides flexible construction of multi-atom quantum systems with configurable geometries, implementing the model systems described in Chapter~\ref{chapter_model_systems}. For the microtubule-inspired models central to this thesis, the implementation supports \textbf{cylindrical arrangements} where atoms are positioned on cylindrical surfaces with specified chain and ring numbers. \textbf{Excitation manifold truncation} restricts the system to single and double excitation subspaces with automatic basis construction, while \textbf{dynamic coupling} enables nearest-neighbor and long-range interactions based on geometric proximity. The framework also incorporates \textbf{inhomogeneous disorder} through site-specific frequency variations sampled from realistic distributions.

\noindent
The system construction automatically handles basis transformations between site and excitation manifold representations, enabling efficient evolution in the appropriate eigenbasis while maintaining physical interpretability of results.